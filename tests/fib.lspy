;==== Fibonacci Test ==========================================================

(def {nil} {})
(def {true} 1)
(def {false} 0)

(def {fun} (\ {f b} {
  def (head f) (\ (tail f) b)
}))

(fun {unpack f l} {
  eval (join (list f) l)
})

(fun {select & cs} {
  if (== cs nil)
    {error "No Selection Found"}
    {if (fst (fst cs)) {snd (fst cs)} {unpack select (tail cs)}}
})

(def {otherwise} true)

(fun {fst l} { eval (head l) })
(fun {snd l} { eval (head (tail l)) })
(fun {trd l} { eval (head (tail (tail l))) })

(fun {fib n} {
  select
    { (== n 0) 0 }
    { (== n 1) 1 }
    { otherwise (+ (fib (- n 1)) (fib (- n 2))) }
})

(fun {test cond} {
    if (cond)
    { print "PASSED" }
    { print "FAILED" }
})

(test (== (fib 0) 0))
(test (== (fib 1) 1))
(test (== (fib 2) 1))
(test (== (fib 3) 2))
(test (== (fib 4) 3))
(test (== (fib 5) 5))
(test (== (fib 6) 8))
(test (== (fib 7) 13))
(test (== (fib 8) 21))
(test (== (fib 9) 34))
(test (== (fib 10) 55))
(test (== (fib 11) 89))
(test (== (fib 12) 144))
